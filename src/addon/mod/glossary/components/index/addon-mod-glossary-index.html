<!-- Buttons to add to the header. -->
<core-navbar-buttons slot="end">
    <ion-button *ngIf="glossary && glossary.browsemodes && glossary.browsemodes.length > 1" slot="icon-only //TODO: mode to icon" (click)="openModePicker($event)" [attr.aria-label]="'addon.mod_glossary.browsemode' | translate">
        <ion-icon name="fa-sort">
        </ion-icon>
    </ion-button>
    <ion-button *ngIf="glossary" slot="icon-only //TODO: mode to icon" (click)="toggleSearch()" [attr.aria-label]="'addon.mod_glossary.bysearch' | translate">
        <ion-icon name="search"></ion-icon>
    </ion-button>
    <core-context-menu>
        <core-context-menu-item *ngIf="externalUrl" [priority]="900" [content]="'core.openinbrowser' | translate" [href]="externalUrl" iconAction="open"></core-context-menu-item>
        <core-context-menu-item *ngIf="description" [priority]="800" [content]="'core.moduleintro' | translate" (action)="expandDescription()" [iconAction]="'arrow-forward'"></core-context-menu-item>
        <core-context-menu-item *ngIf="blog" [priority]="750" content="{{'addon.blog.blog' | translate}}" [iconAction]="'fa-newspaper-o'" (action)="gotoBlog($event)"></core-context-menu-item>
        <core-context-menu-item *ngIf="loaded && !(hasOffline || hasOfflineRatings) && isOnline" [priority]="700" [content]="'core.refresh' | translate" (action)="doRefresh(null, $event)" [iconAction]="refreshIcon" [closeOnClick]="false"></core-context-menu-item>
        <core-context-menu-item *ngIf="loaded && (hasOffline || hasOfflineRatings) && isOnline"  [priority]="650" [content]="'core.settings.synchronizenow' | translate" (action)="doRefresh(null, $event, true)" [iconAction]="syncIcon" [closeOnClick]="false"></core-context-menu-item>
        <core-context-menu-item *ngIf="canAdd" [priority]="600" [content]="'addon.mod_glossary.addentry' | translate" (action)="openNewEntry()" iconAction="add"></core-context-menu-item>
        <core-context-menu-item *ngIf="prefetchStatusIcon" [priority]="500" [content]="prefetchText" (action)="prefetch($event)" [iconAction]="prefetchStatusIcon" [closeOnClick]="false"></core-context-menu-item>
        <core-context-menu-item *ngIf="size" [priority]="400" [content]="'core.clearstoreddata' | translate:{$a: size}" iconDescription="cube" (action)="removeFiles($event)" iconAction="trash" [closeOnClick]="false"></core-context-menu-item>
    </core-context-menu>
</core-navbar-buttons>

<!-- Content. -->
<core-split-view>
    <ion-content>
        <ion-refresher slot="fixed" [disabled]="!loaded" (ionRefresh)="doRefresh($event)">
            <ion-refresher-content pullingText="{{ 'core.pulltorefresh' | translate }}"></ion-refresher-content>
        </ion-refresher>

        <core-course-module-description [description]="description" [component]="component" [componentId]="componentId" contextLevel="module" [contextInstanceId]="module.id" [courseId]="courseId"></core-course-module-description>

        <!-- Glossary entries found to be synchronized -->
        <ion-card class="core-warning-card" slot="start //TODO: mode to icon" *ngIf="hasOffline || hasOfflineRatings">
            <ion-icon name="warning"></ion-icon> {{ 'core.hasdatatosync' | translate:{$a: moduleName} }}
        </ion-card>

        <core-search-box *ngIf="isSearch" (onSubmit)="search($event)" [placeholder]="'addon.mod_glossary.searchquery' | translate" [autoFocus]="true" [lengthCheck]="2" (onClear)="toggleSearch($event)" searchArea="AddonModGlossary-{{module.id}}"></core-search-box>

        <core-loading [hideUntil]="loaded" class="core-loading-center">

            <ion-list *ngIf="!isSearch && offlineEntries.length > 0">
                <ion-item-divider>
                    {{ 'addon.mod_glossary.entriestobesynced' | translate }}
                </ion-item-divider>
                <ion-item *ngFor="let entry of offlineEntries" (click)="openNewEntry(entry)" detail="false">
                    <p><core-format-text [text]="entry.concept" contextLevel="module" [contextInstanceId]="glossary.coursemodule" [courseId]="courseId"></core-format-text></p>
                </ion-item>
            </ion-list>

            <ion-list *ngIf="entries.length > 0">
                <ng-container *ngFor="let entry of entries; let index = index">

                    <ion-item-divider *ngIf="showDivider(entry, entries[index - 1])">
                        {{getDivider(entry)}}
                    </ion-item-divider>

                    <ion-item (click)="openEntry(entry.id)" [class.core-split-item-selected]="entry.id == selectedEntry" detail="false">
                        <p><core-format-text [text]="entry.concept" contextLevel="module" [contextInstanceId]="glossary.coursemodule" [courseId]="courseId"></core-format-text></p>
                    </ion-item>
                </ng-container>
            </ion-list>

            <core-empty-box *ngIf="!entries.length && !offlineEntries.length" icon="list" [message]="'addon.mod_glossary.noentriesfound' | translate"></core-empty-box>

            <core-infinite-loading [enabled]="canLoadMore" (action)="loadMoreEntries($event)" [error]="loadMoreError"></core-infinite-loading>
        </core-loading>

        <ion-fab slot="fixed" core-fab vertical="bottom" horizontal="end" *ngIf="canAdd">
            <ion-fab-button (click)="openNewEntry()" [attr.aria-label]="'addon.mod_glossary.addentry' | translate">
                <ion-icon name="add"></ion-icon>
            </ion-fab-button>
        </ion-fab>
    </ion-content>
</core-split-view>
