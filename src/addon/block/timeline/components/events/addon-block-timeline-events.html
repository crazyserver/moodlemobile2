<ion-item-group *ngFor="let dayEvents of filteredEvents">
    <ion-item-divider [color]="dayEvents.color">
        <h2>{{ dayEvents.dayTimestamp * 1000 | coreFormatDate:"strftimedayshort" }}</h2>
    </ion-item-divider>
    <ng-container *ngFor="let event of dayEvents.events">
        <ion-item class="ion-text-wrap" detail="false" class="core-course-module-handler item-media" (click)="action($event, event.url)" [title]="event.name">
            <img slot="start" [src]="event.iconUrl" alt="" role="presentation" *ngIf="event.iconUrl" class="core-module-icon">
            <h2><core-format-text [text]="event.name" contextLevel="module" [contextInstanceId]="event.id" [courseId]="event.course && event.course.id"></core-format-text></h2>
            <p *ngIf="showCourse && event.course">
                <core-format-text [text]="event.course.fullnamedisplay" contextLevel="course" [contextInstanceId]="event.course.id"></core-format-text>
            </p>

            <ion-button fill="clear" class="ion-hide-md-up" (click)="action($event, event.action.url)" [title]="event.action.name" [disabled]="!event.action.actionable" *ngIf="event.action">
                {{event.action.name}}
                <ion-badge slot="end"  class="ion-margin-start" *ngIf="event.action.showitemcount">{{event.action.itemcount}}</ion-badge>
            </ion-button>

            <ion-badge color="light" slot="end">{{event.timesort * 1000 | coreFormatDate:"strftimetime24" }}</ion-badge>

            <ion-button fill="clear" slot="end" class="ion-hide-md-down" (click)="action($event, event.action.url)" [title]="event.action.name" [disabled]="!event.action.actionable" *ngIf="event.action">
                {{event.action.name}}
                <ion-badge slot="end"  class="ion-margin-start" *ngIf="event.action.showitemcount">{{event.action.itemcount}}</ion-badge>
            </ion-button>
        </ion-item>
    </ng-container>
</ion-item-group>

<div class="ion-padding ion-text-center" *ngIf="canLoadMore && !empty">
    <!-- Button and spinner to show more attempts. -->
    <ion-button expand="block" (click)="loadMoreEvents()" color="light" *ngIf="!loadingMore">
        {{ 'core.loadmore' | translate }}
    </ion-button>
    <ion-spinner *ngIf="loadingMore"></ion-spinner>
</div>

<core-empty-box *ngIf="empty" image="assets/img/icons/activities.svg" [message]="'addon.block_timeline.noevents' | translate" [inline]="!showCourse"></core-empty-box>
